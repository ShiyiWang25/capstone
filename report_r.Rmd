---
title: "Correlation Analysis between Gene Expression and SED (Question 1)"
author: "Shiyi Wang"
date: "12/10/2020"
output:
  pdf_document: default
  html_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

### About the data:
#### Subject: 
Transcriptome data of 41 breast tumors with available three-dimensional tumor diameters is used in this research.

#### Questions:
What are the genes significantly correlated with SED of breast cancers?

#### Object: 
The purpose is to reveal the genes significantly correlated with SED using the filter criteria listed below. The genes significantly correlated with SED might play important roles in tumor development and could be the targets of the following research.

#### Filter criteria:
1. p-Value < 0.01

2. means > 10

3. CV > 1

#### Note:
This is the reproduction of the results in the paper. The data is well-documented and the filter criteria are clear, which helps the reanalysis of data in the future.

```{r}
library(tidyverse)
library(readr)

# import data
data <- read_csv("data/SED_vs_Transcriptome-Profile/Correlation_and_CV.csv") %>%
  print()
```

```{r}
# filter the data using the filter criteria:
data_filtered <- data %>%
  filter(pvalue <0.01) %>%
  filter(Means > 10) %>%
  filter(CV > 1) %>%
  print()
```
```{r}
# How many genes are significantly correlated with SED?
# (i.e., How many genes pass the filter?)
dim(data_filtered)
```

```{r}
# sort the data ascendingly by the "correlation" value
data_sorted <- data_filtered %>%
  arrange(correlation) %>%
  print()

write.csv(data_sorted, 'figure/Correlation_Analysis_results.csv')
```

```{r}
# How many genes show a significant negative correlation with SED?
# (i.e., How many genes have a correlation value < 0?)
data_sorted %>%
  filter(correlation < 0) %>%
  nrow() %>%
  print()
```


```{r}
# How many genes show a significant positive correlation with SED?
# (i.e., How many genes have a correlation value > 0?)
data_sorted %>%
  filter(correlation > 0) %>%
  nrow() %>%
  print()
```

#### Conclusions:

54 genes are found to be significantly correlated with SED. Among them, 39 genes show a significant negative correlation with SED, and 15 genes show a significant positive correlation with SED.

ADAMTS12 is the gene that has the strongest correlation with SED. Its function in tumor development and prognosis should be investigated.

#### Reproducibility:
Both the original data and analyzed results are well-documented in the original paper. Besides, the filter criteria are clear, which helps the reanalysis of data.
In this project, the correlation between gene expression and SED is reproduced using R, and the same results are acquired.


